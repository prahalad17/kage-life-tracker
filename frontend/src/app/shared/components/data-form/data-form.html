<form
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
  class="saas-form">

  <!-- CARD WRAPPER -->
  <div class="form-card">

    <!-- GRID -->
    <div
      class="form-grid"
      [class.grid-2]="config.layout === 'grid' && config.gridColumns === 2"
    >

      @for (field of config.fields; track field.name) {
        @if (!field.hidden) {

          <div class="form-field">

            <label>
              {{ field.label }}
              @if (field.required) {
                <span class="required">*</span>
              }
            </label>

            @switch (field.type) {

              @case ('text') {
                <input
                  type="text"
                  [formControlName]="field.name"
                  [placeholder]="field.placeholder"
                  [class.invalid]="form.get(field.name)?.touched && form.get(field.name)?.invalid"
                />
              }

              @case ('email') {
                <input
                  type="email"
                  [formControlName]="field.name"
                  [placeholder]="field.placeholder"
                  [class.invalid]="form.get(field.name)?.touched && form.get(field.name)?.invalid"
                />
              }

              @case ('password') {
                <input
                  type="password"
                  [formControlName]="field.name"
                  [placeholder]="field.placeholder"
                  [class.invalid]="form.get(field.name)?.touched && form.get(field.name)?.invalid"
                />
              }

              @case ('textarea') {
                <textarea
                  rows="4"
                  [formControlName]="field.name"
                  [placeholder]="field.placeholder"
                  [class.invalid]="form.get(field.name)?.touched && form.get(field.name)?.invalid">
                </textarea>
              }

              @case ('select') {
                <select
                  [formControlName]="field.name"
                  [class.invalid]="form.get(field.name)?.touched && form.get(field.name)?.invalid"
                >
                  <option [ngValue]="null">
                    Select {{ field.label }}
                  </option>

                  @for (opt of dropdownOptions[field.name] ?? []; track opt.value) {
                    <option [ngValue]="opt.value">
                      {{ opt.label }}
                    </option>
                  }
                </select>
              }

            }

            @if (
              form.get(field.name)?.touched &&
              form.get(field.name)?.invalid
            ) {
              <div class="error-text">
                {{ field.label }} is invalid
              </div>
            }

          </div>

        }
      }

    </div>

  </div>

  <!-- ACTIONS -->
  <div class="form-actions">

    @for (action of config.actions; track action.label) {

      <button
        [type]="action.type"
        class="form-btn"
        [class.primary]="action.action === 'submit'"
        [class.secondary]="action.action !== 'submit'"
        [disabled]="action.action === 'submit' && form.invalid"
        (click)="action.action === 'cancel' && onCancel()"
      >
        {{ action.label }}
      </button>

    }

  </div>

  <!-- MESSAGE -->
  @if (message) {
    <div class="form-alert">
      {{ message }}
    </div>
  }

</form>